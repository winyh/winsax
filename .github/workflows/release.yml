name: winsax actions
run-name: ${{ github.actor }} åˆ›å»ºè‡ªåŠ¨åŒ–å‘å¸ƒ ğŸš€

on:
  push:
    branches:
      - release
    tags:
      - "v*" # Push events to matching v*, i.e. v1.0, v20.15.10
  pull_request:
    branches:
      - main # default branch

jobs:
  Winsax-Release-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "ğŸ‰ æµç¨‹é€šè¿‡ ${{ github.event_name }} æ‰§è¡Œ."
      - run: echo "ğŸ§ ä»»åŠ¡æµè¿è¡Œåœ¨ ${{ runner.os }} GitHub æä¾›çš„ä¸»æœº!"
      - run: echo "ğŸ” å½“å‰åˆ†æ”¯ä¸º ${{ github.ref }} ï¼Œå½“å‰ä»“åº“ä¸º ${{ github.repository }}."
      # å°†ä»£ç ä»“åº“çš„å†…å®¹æ£€å‡ºå·¥ä½œç›®å½•ä¸­ï¼Œå¾…ä»¥ä¸‹å·¥ä½œæµä¸­ä½¿ç”¨
      - name: Check out repository code
        uses: actions/checkout@v4
      - run: echo "ğŸ’¡ ä»“åº“ ${{ github.repository }} å·²æ£€å‡ºåˆ° GitHub æœåŠ¡å™¨å·¥ä½œç›®å½•."
      - run: echo "ğŸ–¥ï¸ å³å°†åœ¨GitHubæœåŠ¡å™¨æ‰§è¡Œå·¥ä½œæµ."
      # è®¾ç½® node ç¯å¢ƒç‰ˆæœ¬
      - name: Set node version
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm
      # å®‰è£… npm ä¾èµ–
      - name: Install node modules
        run: npm install
      # ç¼“å­˜ node modules
      - name: Cache node modules
        uses: actions/cache@v4
        env:
          cache-name: cache-node-modules
        with:
          path: ~/.npm
          key: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-build-${{ env.cache-name }}-
      # åˆ—ä¸¾ä»“åº“æ–‡ä»¶
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      # æ„å»ºé¡¹ç›®
      - name: Build
        run: npm run build
      # å‘å¸ƒç‰ˆæœ¬
      - name: Create gitHub Release
        id: create_release
        uses: softprops/action-gh-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        if: startsWith(github.ref, 'refs/tags/')
        with:
          body_path: ${{ github.workspace }}-CHANGELOG.txt
          name: ${{ github.ref }}
          tag_name: ${{ github.ref }}
          draft: false
          prerelease: false
          files: |
            Release.txt
            LICENSE

      - run: echo "ğŸ å½“å‰ä»»åŠ¡æµçŠ¶æ€  ${{ job.status }}."
