name: winsax actions
run-name: ${{ github.actor }} åˆ›å»ºè‡ªåŠ¨åŒ–æ‰§è¡Œ ğŸš€
on: [push]

# on:
#   push:
#     branches:
#       - main # default branch
#   pull_request:
#     branches:
#       - main # default branch

jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "ğŸ‰ æµç¨‹é€šè¿‡ ${{ github.event_name }} æ‰§è¡Œ."
      - run: echo "ğŸ§ ä»»åŠ¡æµè¿è¡Œåœ¨ ${{ runner.os }} GitHub æä¾›çš„ä¸»æœº!"
      - run: echo "ğŸ” å½“å‰åˆ†æ”¯ä¸º ${{ github.ref }} ï¼Œå½“å‰ä»“åº“ä¸º ${{ github.repository }}."
      # å°†ä»£ç ä»“åº“çš„å†…å®¹æ£€å‡ºå·¥ä½œç›®å½•ä¸­ï¼Œå¾…ä»¥ä¸‹å·¥ä½œæµä¸­ä½¿ç”¨
      - name: Check out repository code
        uses: actions/checkout@v4
      - run: echo "ğŸ’¡ ä»“åº“ ${{ github.repository }} å·²æ£€å‡ºåˆ° GitHub æœåŠ¡å™¨å·¥ä½œç›®å½•."
      - run: echo "ğŸ–¥ï¸ å³å°†åœ¨GitHubæœåŠ¡å™¨æ‰§è¡Œå·¥ä½œæµ."
      # è®¾ç½® node ç¯å¢ƒç‰ˆæœ¬
      - name: Set node version dependencies
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: "npm"
          cache-dependency-path: subdir/package-lock.json
      # è¯»å–ç¼“å­˜
      - name: Cache node modules
        uses: actions/cache@v3
        env:
          cache-name: cache-node-modules
        with:
          path: ~/.npm
          key: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-build-${{ env.cache-name }}-
      # å®‰è£… npm ä¾èµ–
      - name: Set node version dependencies
        run: npm install
      # åˆ—ä¸¾ä»“åº“æ–‡ä»¶
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      # æ„å»ºé¡¹ç›®
      - name: Build
        run: npm run build
      # éƒ¨ç½²åˆ°gh-pagesåˆ†æ”¯
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist
          publish_branch: gh-pages # å°† dist ä¸‹é¢çš„äº§å‡ºæ¨é€åˆ°å…³è”ä»“åº“çš„ gh-pages åˆ†æ”¯ï¼Œå¦‚æœæ²¡æœ‰ä¼šè‡ªåŠ¨åˆ›å»º
          dotfiles: true # åŒ…æ‹¬åœ¨æäº¤ä¸­ï¼Œå³ä½¿è¢« .gitignore æ–‡ä»¶å¿½ç•¥
      - run: echo "ğŸ å½“å‰ä»»åŠ¡æµçŠ¶æ€  ${{ job.status }}."
